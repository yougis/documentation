utilisation de Powershell pour les manips

lancer synchro manuellement
`Start-ADSyncSyncCycle -PolicyType Delta`



pour supprimer un user synchronis√© :

```
Set-MsolDirSyncEnabled -EnableDirSync $false
(Get-MSOLCompanyInformation).DirectorySynchronizationEnabled
Set-MsolDirSyncEnabled -EnableDirSync $true
```


installation des librairies :
```
[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
Install-Module MSOnline
```

pour gerer les comptes Azure :
```
Import-Module ServerManager
Add-WindowsFeature RSAT-AD-PowerShell
import-module activedirectory
get-module -listavailable
```


# changer UPN

```
Set-ADUser -Identity "hugo.roussaffa" -UserPrincipalName "hugo.roussaffa@oeil.nc"

Get-MsolUser -UserPrincipalName "hugo.roussaffa@oeil.nc" | Ft userPrincipalName,proxyAddresses
Get-MsolUser -UserPrincipalName "jf.nguyenvansoc@oeil.nc" | Ft userPrincipalName,proxyAddresses
```