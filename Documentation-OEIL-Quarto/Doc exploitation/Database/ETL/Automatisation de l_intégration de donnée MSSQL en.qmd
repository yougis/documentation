# Modification de l'image docker

### Driver MSSQL


installer les drivers dans l'image Docker de gdal

https://docs.microsoft.com/en-us/sql/connect/odbc/linux-mac/installing-the-microsoft-odbc-driver-for-sql-server?view=sql-server-ver15

Ouvrir l'image en `bin/bash`
```
apt-get update
 &&  apt-get install -y gnupg2
curl https://packages.microsoft.com/keys/microsoft.asc | apt-key add -
#Ubuntu 20.04
curl https://packages.microsoft.com/config/ubuntu/20.04/prod.list > /etc/apt/sources.list.d/mssql-release.list
ACCEPT_EULA=Y apt-get install -y msodbcsql17
# optional: for bcp and sqlcmd
ACCEPT_EULA=Y apt-get install -y mssql-tools
echo 'export PATH="$PATH:/opt/mssql-tools/bin"' >> ~/.bashrc
source ~/.bashrc
# optional: for unixODBC development headers
apt-get install -y unixodbc-dev
```
Penser à sortir et commit de l'image

# pour Debian
```
sudo apt-get update
 &&  sudo apt-get install -y gnupg2
curl https://packages.microsoft.com/keys/microsoft.asc | apt-key add -
#Debian 11
curl https://packages.microsoft.com/config/debian/11/prod.list > /etc/apt/sources.list.d/mssql-release.list
ACCEPT_EULA=Y apt-get install -y msodbcsql17
# optional: for bcp and sqlcmd
ACCEPT_EULA=Y apt-get install -y mssql-tools
echo 'export PATH="$PATH:/opt/mssql-tools/bin"' >> ~/.bashrc
source ~/.bashrc
# optional: for unixODBC development headers
sudo apt-get install -y unixodbc-dev
``````

## Parametre de connection à utiliser

exemple
`"MSSQL:database=ALERTE_INCENDIE_v2;server=geoportail.oeil.nc,1435;uid=hroussaffa;pwd=mcot;tables=POINT_CHAUD_VIIRS;driver=ODBC Driver 17 for SQL Server"`

Commande docker complete:
```
docker run --rm -v //media/commun/Informatique/SIG/Donnees:/home osgeo/gdal:ubuntu-full-latest ogrinfo -al  "MSSQL:database=ALERTE_INCENDIE_v2;server=geoportail.oeil.nc,1435;uid=hroussaffa;pwd=mcot;tables=POINT_CHAUD_VIIRS;driver=ODBC Driver 17 for SQL Server"
```


``` docker run --rm -v //media/commun/Informatique/SIG/Donnees:/home osgeo/gdal:ubuntu-full-latest ogr2ogr -f "PostgreSQL" PG:"host=172.20.12.13 port=5432 user=hroussaffa dbname=oeil_reference password=mcot" -lco SCHEMA=feux -overwrite "MSSQL:database=ALERTE_INCENDIE_v2;server=geoportail.oeil.nc,1435;uid=hroussaffa;pwd=mcot;tables=INCENDIE_MODIS;driver=ODBC Driver 17 for SQL Server" -nlt PROMOTE_TO_MULTI -nlt CONVERT_TO_LINEAR -lco precision=NO
```