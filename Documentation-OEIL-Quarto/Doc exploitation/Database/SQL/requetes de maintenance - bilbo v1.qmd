# Recalculer des données manquantes

l'utilisation des Hex_Id permet de savoir si une zone n'a pas été traité.

Il faut joindre les données hexa global avec les données de traitement pour savoir s'il y a des Hexagones non traités.


Ici on traite pour l'année 2006 seulement

```sql
--refaire tous les hexa manquants

insert into surfor.H3_NON_TRAITEE_nc_6
SELECT t1.hex_id, t1.geometry, 2006 as annee
FROM bilbo.h3_nc_6  t1
LEFT JOIN "surfor"."faits_TMF_annualChangeCollection_h3_nc_6" 
t2 ON t1.hex_id = t2.hex_id
AND t2.id_spatial = '0'
AND t2.annee = 2006
WHERE t2.hex_id IS NULL;


```


un autre cas : 

```sql
with H3_NON_TRAITE_ACC_nc_6 as(
	SELECT t1.hex_id, t1.geometry, '2013' as annee
	FROM bilbo.h3_nc_6  t1
	LEFT JOIN "processing"."faits_TMF_acc_h3_nc_6" t2
	ON t1.hex_id = t2.hex_id
	AND t2.id_spatial = '0'
	AND t2.annee = '2013'
	WHERE t2.hex_id IS NULL
)

select * INTO h3_non_traite_acc_2013 from H3_NON_TRAITE_ACC_nc_6 ;
```