```sql
SELECT cid, ST_union(wkb_geometry) AS cluster_geom, array_agg(idoccurenc) AS ids_in_cluster, COUNT(*)   AS row_count FROM (
    SELECT idoccurenc, ST_ClusterDBSCAN(wkb_geometry, eps := 0.5, minpoints := 5) over () AS cid, wkb_geometry
    FROM endemia.perimetre_alerte_espmenacees_endemia_sansdoublon) sq
GROUP BY cid;
```


